## 概要

単回帰分析の手法とその一般的な考え方を学びましょう。単回帰分析の一般的な考え方は高校数学の範囲でわかるレベルです。緊張せずに進みましょう。

# この章の目標

**推定完了時間:1時間**

　回帰分析とはなんでしょうか？おそらく、大半の方が初耳でしょう。回帰分析とは、関数をデータに当てはめることによって、ある目的変数の変動を説明変数の変動により説明・予測・影響関係を検討するための手法です。
　それでは、回帰分析の一種である、単回帰分析について学習しましょう。
　回帰分析だけでも専門書になるくらい本来は奥が深いのだということは心のどこかにとめて置いてください。

**1. scikit-learnを用いた単回帰分析の手法を学ぶ**

# 単回帰分析とは
　単回帰分析は、目的変数に対して１つの説明変数でその結果を説明しようという分析手法です。直感的に、平面上に直線を引くことができ、
$$y=ax+b (a,bは実数)$$
のように表すことができ単純でわかりやすいのがメリットです。ですが、多くの社会的問題には複雑な要素が噛み合っており用いれないことがほとんどですが、基礎となってる重要な考え方ですし、実験データには使えることが多いです。
　例えば、バネの伸びを図る実験では、

$$y=\frac{1}{2}kx$$

バネの伸びは以上のように示されるため、単回帰分析を用いることができます。
ですので、決して役に立たないものではないので学んでみることにしましょう。

![](/media/editor/D-3回帰の有効性_20201130142720346513.png)

## 次元と種類を統一しよう

　まず、用いるデータの確認をしましょう。データは**目的変数['target']**と**説明変数['LSTAT']**です。ここでまず、それぞれのデータ型を確認してみましょう。

#### <font color='blue'>目的変数['target']と説明変数['LSTAT']それぞれのデータ型と次元を確認してみましょう</font>

```python
　data = pd.DataFrame(dataset.data, columns=dataset.feature_names)
```

のdataの中から目的変数の['LSTAT']だけを取り出すにはどうしたら良いでしょうか？調べてみましょう。
また、データ型を確認するには関数**type**メソッドを使えばよかったでしたね！

##### [演習解答](/answer/18)

## データ型の次元と大きさを確認しよう

#### <font color='blue'>データ型の次元と大きさを変更する方法を使ってみよう</font>
　データの次元を確認するには**reshape**メソッドを使います。実際に使い方を調べて使ってデータの大きさをLSTATデータを2次元（506,１）行列に変換してみましょう。
　これは、回帰分析のアルゴリズムに入れるためです。

##### [演習解答](/answer/19)

## scikit-learnを用いて単回帰分析をしてみよう
　scikit-learnで単回帰分析を行うには、<font color='red'>**LinearRegression()モデル**</font>を使います。LinearRegression()関数について知りましょう。

### LinearRegression()を知ろう
　LinearRegression()モデルは線形回帰を行うモデルです。説明されても何がなんだかわからないと思いますので、早速使ってみましょう！
　先ほどみた目的変数targetと説明変数LSTATをLinearRegression()の**fit**を使って単回帰分析します。

######<font color='red'>scikit-learnのLinearRegression()モデルをimportして単回帰分析をしてみよう</font>

```python
#わかりやすいようにxとyと平面の軸名と一致させる
xdata = lstat
ydata = value

from sklearn.linear_model import LinearRegression

model = LinearRegression()
lin_reg=model.fit(xdata,ydata)
```

「え、これだけなの」と思いませんか？単回帰分析はこれだけで終了なのです。本来の回帰分析の後ろにある理論はそれだけで分厚い専門書になってしまうのでここでは割愛します。
これで、LSTATとTARGETの間の関係性を持った直線を引くことができました。この切片と傾きを表示させてみましょう。表示するためには、LinearRegressionは、**intercept_ で切片、coef_ で回帰変数（傾き）**を求めることができます。

#### <font color='blue'>LinearRegressionで求めたモデルの切片、回帰変数（傾き）を求めてみましょう</font>

##### [演習解答](/answer/20)


　この傾きと切片は、以下のようなグラフになることを示しており、LSTATの値を入れることで住宅価格を予測できることを示しています。

![](/media/editor/D-4切片と傾きで住宅価格を推測できる_20201130142749843885.png)

### グラフにしてみよう
　これだけでは、何が何だかコンピューターや学者にわかっても一般の人にはわかりませんし、学者でない人にもわからないでしょうね。ですのでわかりやすいように先程のようなグラフを書いてみましょう。その際にはmatplotlibというのを使います。次はmatplotlibの使い方を学びましょう。

# まとめ
　ここでは、回帰分析の手法を学習しました。実際にこれを視覚的にわかりやすいようにグラフにしてみましょう。