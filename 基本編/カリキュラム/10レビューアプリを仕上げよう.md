## 概要
今回は、複数レビューを持つ配列から1つずつレビューを表示させたり、選択したレビュー内容を表示させるところまで進め、アプリを完成させます

# この章の目標
**推定完了時間:45分**

**1. 配列の繰り返し処理や値の取得方法を学ぶ**

　複数のレビューを持つ配列を定義できました。この配列に対して行う繰り返し処理の使い方と、配列が持つ値の取得方法を学びましょう。



# ⑦レビュー選択表示機能

　いよいよ最後です。今回はこれまで保留していた「レビューを読む」プログラムを実装していきます。

### このステップでできること

- 配列に対して繰り返し処理を行えるようにする
- 配列から要素を取り出す

いま一度「レビューを読む」の流れを見ていきましょう。

**メニュー画面で<font color='red'>1</font>を入力**

```python
レビュー数：3
[0]レビューを書く
[1]レビューを読む
[2]アプリを終了する
1
```

**<font color='red'>1</font>入力後、メニューのリスト表示**

```python
[0]：時をかける少女のレビュー
[1]：トレモロのレビュー
[2]：るろうに剣心のレビュー

見たいレビューの番号を入力してください：
# 入力待ち
```

**表示されたリスト番号の数字を入力後**

```python
ジャンル : マンガ
---------------------------
タイトル : るろうに剣心
---------------------------
感想 :
映画もいいけどやっぱりマンガが最高！
---------------------------
```

以上の流れがレビュー表示機能になります。

まず、見たいレビューの順番を入力してそのレビューを表示させるようにしましょう。

## 選択したレビューを表示しよう

　レビュー情報はすでに格納されています。やりたいことは、選択したレビュー情報を取得して、表示することです。

### 配列から要素を取り出そう

　⑥でレビューを配列で管理することを学びました。ここではその配列から**選んだ順番の要素を取得**できるようにしましょう。

### 添字(インデックス)

　配列は **順番で値を管理している** ことは⑥で学びましたね。配列は順番を指定することで対応する値を取得することができます。
この順番として割り当てられた数字を**添字**または**インデックス**と呼びます。
　以下の書き方で配列から指定した添字の要素を取得できます。

```python
配列[添字]
```

　配列に続けて、大括弧<font color='red'>**[]**</font>とその中に取得したい値の添字を指定します。


###### <font color='red'>コードブロックに以下を追加して、配列animalから「いぬ」を取り出し出力してみましょう</font>

```python
animals = ["いぬ", "ねこ", "ねずみ"]

# printを使い「いぬ」を出力する
```

　うまく出力できましたか？おそらく多くの方は以下のように書いたのではないでしょうか。

```python
animals = ["いぬ", "ねこ", "ねずみ"]

print(animals[1])
```

しかし、出力結果を見ても分かるように、
<font color='red'>**animals[1]**</font>で取得できるのは「ねこ」でした。

実は**配列の順番は0から始まります**。つまり<font color='red'>**animals[1]**</font>は配列animalsの2番目の値を取得しているということになります。

![](/media/editor/B-10配列のインデックスについて_20201129165609706615.png)

　よって1番目の「いぬ」を取得するための正しいコードは<font color='red'>**animals[0]**</font>となります。

```python
animals = ["いぬ", "ねこ", "ねずみ"]

print(animals[0])
```

### 指定した番号のレビューを表示させる

　それでは、実際に「レビューを読む」を実装していきましょう。「レビューを読む」の処理をまとめた関数read_reviewsに書き足していきます。ここで作る機能は以下です。

#### <font color='blue'>メニューで"[1]:レビューを読む"を選んでから、配列postsに保存してあるレビューの順番のいずれかを入力した時に、その入力した順番のレビューを表示させるようにしましょう</font>

**見たいレビューの番号を入力させる**

メニューで<font color='red'>**1**</font>:レビューを読むを入力後

```python
見たいレビューの番号を入力してください：
# 入力待ち
```

**その番号のレビューのジャンル、タイトル、感想を表示する**
レビューの番号を入力後

```python
ジャンル : マンガ
---------------------------
タイトル : るろうに剣心
---------------------------
感想 : 映画もいいけどやっぱりマンガが最高！
---------------------------
```

##### [演習解答](/answer/16)

## 配列に対して繰り返し処理を行おう
 最後の実装です。現在の段階では見たいレビューの番号を入力させるだけで、何番目に何のレビューが入ってるかわかりません。そこで「レビューを読む」を選択したら **閲覧できるレビューの一覧が表示** されるようにしましょう。レビューの一覧ではそのレビューの「タイトル」とそのレビューの「順番」を表示させるようにします。

```python
[0]：時をかける少女のレビュー
[1]：トレモロのレビュー
[2]：るろうに剣心のレビュー

見たいレビューの番号を入力してください：
# 入力待ち
```

 レビューの一覧の表示をするには **配列postsの要素すべてに表示の処理を行う** 必要があります。
ここで、配列に対する繰り返し処理をもっと簡単に行える**for文**について学びましょう。

### for文

　実は、こういったリストの要素を順番に参照する処理は非常によく行われるため、専用の文法であるfor文が用意されています。for 文は、**リスト**から要素を一つずつ順番に取り出し、それぞれの要素ごとに、処理を、一度ずつ実行します。**変数名**には、リストから取り出した要素が代入されます。
　for文は以下のように使います。

```python
for 変数名 in リスト:
    処理
```

　変数には繰り返しごとに配列内の要素が代入されていきます。試しにコードを書き確かめてみましょう。

###### <font color='red'>コードブロックに以下を追加して実行してみましょう</font>

```python
animals = ["いぬ", "ねこ", "ねずみ"]

for animal in animals:
  print(animal)
```

上のコードでは配列animalsの要素を1つずつ変数animalに入れてprint(animal)の処理を行っています。配列の要素は動物の名前なので、その共通項をとって変数名をanimalにしています。

配列の要素["いぬ", "ねこ", "ねずみ"]のすべてが出力されていたと思います。

## 選択できるレビューの一覧を表示しよう

　配列の要素全てに対して繰り返し処理を行うfor文について学習しました。レビューアプリに応用してアプリケーションを完成させましょう。

メニューで「レビューを読む」を選択するために<font color='red'>**1**</font>を入力したらレビューの一覧を表示させてから、見たいレビューの番号を入力させるようにしましょう。レビューの一覧は以下のように
**[順番]："タイトル"のレビュー**
というフォーマットで表示させましょう。

#### <font color='blue'>forで繰り返しを使って全てのレビュー表示させよう</font>

##### [演習解答](/answer/17)


## 処理の流れ

```python
def post_review(a_posts):
  post = {}
  print("ジャンルを入力してください：")
  post['genre'] = input()
  print("タイトルを入力してください：")
  post['title'] = input()
  print("感想を入力してください：")
  post['review'] = input()
  line = "---------------------------"

  # レビューの描画
  print("ジャンル : {genre}\n{line}".format(genre=post['genre'], line=line))
  print("タイトル : {title}\n{line}".format(title=post['title'], line=line))
  print("感想 :\n{review}\n{line}".format(review=post['review'], line=line))

  return a_posts.append(post)

def read_reviews(a_posts):
  # リストの表示
  number = 0
  for post in a_posts:
    print("[{number}]：{title}のレビュー".format(number=number, title=post['title']))
    number += 1

  print("\n見たいレビューの番号を入力してください：")
  review_input = int(input())

  # レビューの取得
  post = a_posts[review_input]

  # レビューの描画
  line = "---------------------------"

  # レビューの描画
  print("ジャンル : {genre}\n{line}".format(genre=post['genre'], line=line))
  print("タイトル : {title}\n{line}".format(title=post['title'], line=line))
  print("感想 :\n{review}\n{line}".format(review=post['review'], line=line))

def exception():
  print("入力された値は無効な値です")

# 配列オブジェクトpostsの生成
posts = []

while True:
  # メニューの表示
  print("レビュー数：{review_num}".format(review_num=len(posts)))
  print("[0]レビューを書く")
  print("[1]レビューを読む")
  print("[2]アプリを終了する")

  user_input = int(input())

  if user_input == 0: # 「レビューを書く」
    post_review(posts)
  elif user_input == 1: # 「レビューを読む」
    # レビューを読む
    read_reviews(posts)
  elif user_input == 2: # 「プログラムを終了する」
    break
  else:
    exception()
```

### 処理の流れ

- 2~5

```python
def post_review():
  # レビューの投稿

def read_reviews():
  # レビューの閲覧

def exception():
  # エラー処理
```

　コードの開始である、2行目から52行目まででプログラムで使用する関数をすべて定義します。これで52行目以降で、いま定義した関数を自由に使うことができます。

- 55

```python
posts = []
```

　メニューの表示やレビューの投稿、表示といったメインの処理があるwhile文より前で、複数のレビューを管理するための配列postsを定義します。

- 57

```python
while True:
```

アプリケーションのメインの処理である
<font color='red'>**「メニューの表示」 → 「ターミナルからの入力」 → 「入力に応じた処理」**</font>
という流れは「プログラムを終了」するまで繰り返し続けます。

そのためこれらの処理のかたまりをwhile文で囲み、条件式をtrueにすることでbreakするまで繰り返し続けるようにします。breakはメニューで「2」を入力(プログラムの終了を選択)すると呼ばれます。

- 59~62

```python
 print("レビュー数：{review_num}".format(review_num=len(posts)))
  print("[0]レビューを書く")
  print("[1]レビューを読む")
  print("[2]アプリを終了する")
```

　メニューの表示を行います。また、今まで投稿したレビューの数を配列のlen()関数を使って表示します。

```
user_input = int(input())
```

　メニューのうち、どれを選択するかを<font color='red'>**input()関数**</font>を使ってターミナルから入力させます。

- 65~73

```python
if user_input == 0: # 「レビューを書く」
    post_review(posts)
elif user_input == 1: # 「レビューを読む」
    # レビューを読む
    read_reviews(posts)
elif user_input == 2: # 「プログラムを終了する」
    break
else:
    exception()
```

ターミナルから入力した値によって処理を分岐させます。処理の分岐にはif文を使います。

2を入力したときは<font color='red'>**end_program**</font>関数を呼び出し、その中でbreakを使いプログラムを終了させます。
無効な値の場合は<font color='red'>**exception**</font>関数を呼び出し、無効な値であることを知らせます。

ターミナルで「1」を入力した場合、レビューを閲覧するための関数<font color='red'>**read_reviews**</font>を呼び出します。このとき引数としてレビューを管理する配列オブジェクト<font color='red'>**posts**</font>を渡します。

- 25~44

```python
def read_reviews(a_posts):
  # リストの表示
  number = 0
  for post in a_posts:
    print("[{number}]：{title}のレビュー".format(number=number, title=post['title']))
    number += 1

  print("\n見たいレビューの番号を入力してください：")
  review_input = int(input())

  # レビューの取得
  post = a_posts[review_input]

  # レビューの描画
  line = "---------------------------"

  # レビューの描画
  print("ジャンル : {genre}\n{line}".format(genre=post['genre'], line=line))
  print("タイトル : {title}\n{line}".format(title=post['title'], line=line))
  print("感想 :\n{review}\n{line}".format(review=post['review'], line=line))
```

　何番目に書いたレビューかわかるように番号用の変数<font color='red'>**num**</font>を定義します。
　配列オブジェクトのすべての要素に対して繰り返し処理を行うには<font color='red'>**for**</font>文を使います。

```python
for 変数 in リスト
　処理
```

次に、詳細を見たいレビューの番号をターミナルから入力させます。

```python
print("\n見たいレビューの番号を入力してください：")
review_input = int(input())
```

　入力された値の順番のレビューを配列から取り出します。配列から特定の順番の要素を取り出すのは<font color='red'>**配列[添字]**</font>という書き方をするのでした。

```python
post = a_posts[input]
```

　これで変数<font color='red'>**post**</font>には指定した番号のレビューのハッシュが代入されています。あとは詳細を表示させるだけです。

```python
print("ジャンル : {genre}\n{line}".format(genre=post['genre'], line=line))
  print("タイトル : {title}\n{line}".format(title=post['title'], line=line))
  print("感想 :\n{review}\n{line}".format(review=post['review'], line=line))
```

これですべての処理の流れは終了です。よくわからなかった場所があった方は戻って処理の流れを再確認してください。

# 以上でレビュー管理アプリケーションは完成です！

　以上ですべての実装は終わりました。70行程度のソースコードの量ですが立派にアプリケーションとして機能していると思います。このアプリケーションが作れれば基本は押さえられています。今後さらに発展的なアプリケーションの開発ができるでしょう。
　お疲れ様でした。
　ここまでで学んだpythonの基礎文法を確認しながら自分でミニアプリを作ってみましょう。

### 余力があればもう少し発展させよう

予定した機能は完成しましたが、まだまだこのアプリケーションには発展の余地があります。

例を挙げると以下のような部分です。

- 入力するレビュー項目を増やす
- レビューが1つも書かれていないときに「レビューを読む」は選べなくする
- 入力された見たいレビューの番号が、レビュー数より大きい場合に再入力させる
- レビューの表示を別関数として分ける

 もちろんこれらの改善を必ずしもすべて行う必要はありません。さらに、ここではこれらの解答は教えません。
しかし自分で考えてプログラムを組むことはレベルアップに大きく繋がります。ぜひとも余力がある人は挑戦してみてください！

# まとめ

レビューアプリの作成を通してプログラミング言語Pythonの基本的概念を抑えました。この基本的概念はPythonに限らず、プログラミング言語全体に共通するものです。ですので、これから他のプログラミング言語を学習する際にも役立つことでしょう。
さて、そんな概念ですが、さらに定着させるために自分で自作アプリを作りましょう。